Format: Fall24-October10
Language: ru
Title: Как мы делали Mad Racer
Slug: %d0%ba%d0%b0%d0%ba-%d0%bc%d1%8b-%d0%b4%d0%b5%d0%bb%d0%b0%d0%bb%d0%b8-mad-racer
Categories: blog,hottest
<p><em>Привет дорогой читатель. В этой заметке я опишу <a href="https://play.google.com/store/apps/details?id=mad.racer.free" target="_blank">свой опыт создания первой игры для мобильников Андроид</a>. Многим людям нравится эта история, я считаю ее необходимо опубликовать. Это не история успеха, но думаю многим начинающим разработчикам даст понимание с чего начинать и что нужно делать для создания простенькой игры. Обязательно опишу свои ошибки, и что можно было сделать лучше.<br />
</em></p>
<p style="text-align: center;"><a href="https://en.wikipedia.org/wiki/Tank_Girl" target="_blank"><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-116" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/Hewl-Tanky-294x300.jpg" alt="Hewl-Tanky" width="294" height="300" srcset="https://demensdeum.com/blog/wp-content/uploads/2015/12/Hewl-Tanky-294x300.jpg 294w, https://demensdeum.com/blog/wp-content/uploads/2015/12/Hewl-Tanky-147x150.jpg 147w, https://demensdeum.com/blog/wp-content/uploads/2015/12/Hewl-Tanky.jpg 300w" sizes="auto, (max-width: 294px) 100vw, 294px" /></a></p>
<p style="text-align: center;">Да простят меня <span class="st"><em>Jamie Hewlett</em> и Alan Martin</span>, публикую отличный арт <a href="https://en.wikipedia.org/wiki/Tank_Girl" target="_blank">Tank Girl</a> без их разрешения</p>
<p>Иногда впадаешь в такое состояние, в котором хочется создать что-то эдакое, чтобы все ахнули и разинув рты говорили &#8220;<strong>Ну ты крут</strong>&#8220;. Такая история случилась со мной в 2011 году, когда я посмотрев отрывок фильма &#8220;Tank Girl&#8221; загорелся идеей создать аркадную игру в комиксном стиле.<br />
Почему для Андроид, а не iOS? Причина проста &#8211; у меня не было макинтоша и айфона, зато было огромное желание поддержать Линукс на мобильниках. В то время мне нравилась идеология FSF, а Ричард Метью Столлман был моим божеством.</p>
<p style="text-align: center;"><iframe loading="lazy" src="https://www.youtube.com/embed/9sJUDx7iEJw" width="420" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe><br />
Песня линукс хакеров. Прежде чем петь &#8211; поверь в мир во всем мире</p>
<p style="text-align: left;">На момент разработки последней версией андроид был 2.0, также необходимо было оставить поддержку для старых версий, так как пользователей 1.6 было очень много. Многие производители телефонов даже не выпускали обновлений до версии 2.0.</p>
<p style="text-align: left;">Я сразу поставил временные рамки для реализации данного проекта &#8211; один месяц. За это время предстояло подтянуть знания по Java, изучить Android SDK, Eclipse, встретиться с монстром в лице OpenGL ES и положить его на обе лопатки. Со стороны графики предстояло создать около шести 3d моделей, оптимизированных для мобильников. Также необходимо было выпустить проект на золото в Android Market, в то время Google Play назывался так)</p>
<p style="text-align: center;"><a href="http://www.jpct.net/jpct-ae/" target="_blank"><img loading="lazy" decoding="async" class="size-full wp-image-120 aligncenter" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/jpct_logo.png" alt="jpct_logo" width="200" height="109" /></a><br />
<a href="http://www.jpct.net/jpct-ae/" target="_blank">jPCT-AE</a> бесплатный 3д движок для Андроида</p>
<p style="text-align: left;">Так как времени было мало, необходимо было выбрать готовый 3d движок. Создать свой движок с нуля можно, но не очень продуктивно, так как на тестирование и совместимость со всеми устройствами уйдет большая часть времени. До прихода Unreal Engine, Unity, ThreeJS (HTML5), лидирующим движком был JPCT-AE. Движок поставлялся в виде готовой java библиотеки, поддерживал старые версии андроида. Также его создатель EgonOlsen оперативно занимается поддержкой и исправлением ошибок по запросу разработчиков.</p>
<p style="text-align: center;"><a href="http://demensdeum.com/blog/2015/12/19/anthony/" target="_blank"><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-122" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/antonHooligan-252x300.jpg" alt="antonHooligan" width="252" height="300" srcset="https://demensdeum.com/blog/wp-content/uploads/2015/12/antonHooligan-252x300.jpg 252w, https://demensdeum.com/blog/wp-content/uploads/2015/12/antonHooligan-126x150.jpg 126w, https://demensdeum.com/blog/wp-content/uploads/2015/12/antonHooligan.jpg 300w" sizes="auto, (max-width: 252px) 100vw, 252px" /></a></p>
<p style="text-align: left;">Кадры решают все &#8211; хулиган <a href="http://demensdeum.com/blog/2015/12/19/anthony/" target="_blank">Антон</a> согласился написать музыку для игры. Я всегда восхищался его творчеством, его работа послужила локомотивом движущим весь геймплей, заставляющим пользователя играть до последнего сбитого вертолета.</p>
<p style="text-align: left;">Столько всего, с чего же начать? Начать надо с установки Android SDK. Сейчас она поставляется со встроенным IDE &#8211; Android Studio. Но на тот момент IDE и SDK поставлялись отдельно. По документации на сайте Google произвел установку Android SDK, Eclipse. Также были установлены необходимые пакеты для Eclipse обеспечивающие сборку и запуск эмулятора Андроид. Через час я собрал тестовый проект jpct-AE:</p>
<p style="text-align: center;"><iframe loading="lazy" src="https://www.youtube.com/embed/WKOelV5EFOs" width="420" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<p style="text-align: left;">Это было ухты! Но в эмуляторе телефона все тормозило очень сильно. Поэтому было принято решение купить телефон на платформе Андроид. Для этих целей был приобретен LG Optimus One P500. С тех пор я не пользуюсь отличными кнопочными телефонами нокиа на платформе Симбиан) Были проблемы с подключением телефона к Линуксу, если кто-то с ними встречается до сих пор, то проверьте настройки udev.</p>
<p style="text-align: center;"><iframe loading="lazy" src="https://www.youtube.com/embed/CW0DUg63lqU" width="420" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe><br />
Джобс цитирует Пабло Пикассо</p>
<p style="text-align: left;">Посмотрев на Alien Runner, я понял что инопланетянина можно заменить на мотоцикл и двух панков с базукой, поляну вокруг превратить в мегаполис, а туман заменить на ночь из баллад Iron Maiden.</p>
<p style="text-align: left;">Как делать 3д модели? Да очень просто, открываешь урок по созданию low-poly моделей на Youtube и делаешь. Весь процесс заключался в обводке проекций в 3д редакторе. Мною были найдены чертежи вертолета Apache, и была сделана модель вертолета. Текстуры были взяты из открытых источников армии сша.</p>
<p style="text-align: left;"><img loading="lazy" decoding="async" class="size-medium wp-image-126 aligncenter" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/McDONNELL_DOUGLAS_AH-64_APACHE-300x201.png" alt="McDONNELL_DOUGLAS_AH-64_APACHE" width="300" height="201" srcset="https://demensdeum.com/blog/wp-content/uploads/2015/12/McDONNELL_DOUGLAS_AH-64_APACHE-300x201.png 300w, https://demensdeum.com/blog/wp-content/uploads/2015/12/McDONNELL_DOUGLAS_AH-64_APACHE-224x150.png 224w, https://demensdeum.com/blog/wp-content/uploads/2015/12/McDONNELL_DOUGLAS_AH-64_APACHE.png 574w" sizes="auto, (max-width: 300px) 100vw, 300px" /></p>
<p style="text-align: left;">Зачем нужен вертолет в игре с двумя панками и базукой? Когда я играл в прототип, то заметил что игрок может просто стоять на месте и набивать очки. Идеальным решением оказался вертолет, который прилетает и закидывает игрока субмаринными торпедами, не давая ему останавливаться.</p>
<p style="text-align: left;">В мобильных приложениях и играх того времени остро выражена проблема нехватки памяти, как на самом телефоне, так и в оперативной памяти. Производительность была тоже на троечку. Один ARM процессор с частотой 300-500 мгц. В результате тестирования на телефонах друзей, оказалось что у HTC в два раза меньше видеопамяти чем в LG, 8мб и 4мб со-но, из-за чего игра выбивала лимиты памяти и не запускалась. Все ресурсы были ужаты до того состояния, чтобы получить фреймрейт 30 кадров в секунду, и возможность запускаться почти на всем.</p>
<p style="text-align: center;"><iframe loading="lazy" src="https://www.youtube.com/embed/B4KqJYDwxsk" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe><br />
<em>Не повторять!</em></p>
<p style="text-align: left;">В Alien Runner управление осуществлялось с помощью нажатий на экран. Такой тип управления мне показался не удобным, я реализовал управление с помощью акселерометра. Тоесть поворачиваешь телефон &#8211; поворачивается мотоцикл. Мне так понравилось что я даже добавил вид от первого лица, для самых смелых.</p>
<p style="text-align: left;">Поддержка со стороны разработчика движка jpct-AE мне понадобилась когда я увидел что в игре исчезает затемнение впереди. Это происходило после сворачивания и разворачивания приложения. Я создал тему на форуме jpct-AE и уже через два дня проблема была решена. Я интегрировал исправленную версию движка в игру.</p>
<p style="text-align: left;">Также стоял вопрос как реализовать бесконечную подачу машин. Для мобильной игры необходимо было придумать способ обеспечивающий добавление машин на игровую сцену БЫСТРО. Вариант с загрузкой из медленной памяти или sd карты был сразу отвергнут. На помощь пришел паттерн проектирования под названием объектный пул. Когда машина выходила из области видимости или уничтожалась, то она отключалась и в момент когда требовалось подать новую машину в начало сцены &#8211; то она включалась и ставилась туда.</p>
<p style="text-align: left;"><a href="https://play.google.com/store/apps/details?id=mad.racer.free" target="_blank"><img loading="lazy" decoding="async" class="size-medium wp-image-131 aligncenter" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/android-market-300x190.jpg" alt="android-market" width="300" height="190" srcset="https://demensdeum.com/blog/wp-content/uploads/2015/12/android-market.jpg 300w, https://demensdeum.com/blog/wp-content/uploads/2015/12/android-market-237x150.jpg 237w" sizes="auto, (max-width: 300px) 100vw, 300px" /></a></p>
<p style="text-align: left;">Чтож настал день релиза. Игра была оттестирована, предварительный показ друзьям проведен, теперь предстояло выйти в золото на Android Market. Регистрация в Android Market  стоила 20$, оплачена. Добавлено описание, скриншоты. И в этот момент я понял что нужно записать видео.</p>
<p style="text-align: left;">Как записать видео для мобильного  проекта? Неужели снимать мобильный телефон на камеру, а потом выкладывать? Решение было интересным, я использовал Андроид эмулятор, отыграл в игру с фреймрейтом  два кадра в секунду, записав все происходящее на экране с помощью  программы которая называется примерно так gtkDesktopRecorder. С помощью VirtualDub скорость видео была увеличена до 30 кадров в секунду. Потом в лучшей программе для редактирования видео &#8211; Windows Movie Maker я добавил все игровые звуки и музыку.</p>
<p style="text-align: left;">Теперь настал момент ошибок. В раскрутку проекта не было вложено ничего, ни усилий, ни денег. <strong>Я тогда считал что проект отобьет сам себя</strong>. Игра ушла на золото, я создал тему на форуме jpct-AE о Mad Racer. Я получил 12 установок по доллару за две недели. <em>И обнаружил игру в бесплатном доступе на куче варезных сайтов на следующий же день</em>.</p>
<p style="text-align: left;">Напевая песню FSF &#8220;Share the software&#8221; я решил сделать бесплатную версию, с рекламой. Игра была переведена в разряд AdWare, внизу появился рекламный баннер от сети AdMob. Интеграция с рекламной системой прошла гладко. За месяц игра была установлена на десять тысяч устройств. Из рекламной сети я получил 50$.</p>
<p style="text-align: left;">Вообщем не забывайте о рекламе, я считаю что это должна быть одна из главнейших статей расходов на ваш проект.</p>
<p style="text-align: left;">Из положительных сторон хочу отметить получение мной места iOS разработчика в одной из лучших компании нашего города. И конечно же бесценный опыт.</p>
<p style="text-align: left;"><a href="https://play.google.com/store/apps/details?id=mad.racer.free"><img loading="lazy" decoding="async" class="size-full wp-image-21 aligncenter" src="https://demensdeum.com/blog/wp-content/uploads/2015/12/madracerLogo.png" alt="madracerLogo" width="300" height="300" srcset="https://demensdeum.com/blog/wp-content/uploads/2015/12/madracerLogo.png 300w, https://demensdeum.com/blog/wp-content/uploads/2015/12/madracerLogo-150x150.png 150w" sizes="auto, (max-width: 300px) 100vw, 300px" /></a>Ссылка на <a href="https://play.google.com/store/apps/details?id=mad.racer.free" target="_blank">Google Play</a></p>
<p style="text-align: left;">Если понравилась статья, сделай репост вконтакте, Facebook)</p>